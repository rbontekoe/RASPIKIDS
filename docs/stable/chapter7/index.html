<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>7 MQTT broker installeren · RASPIKIDS</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="RASPIKIDS logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">RASPIKIDS</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Toepassingen met de Raspberry Pi</a></li><li><a class="tocitem" href="../blog/">Blog</a></li><li><span class="tocitem">Sectie 1 - Basis installaties</span><ul><li><a class="tocitem" href="../chapter1/">1 Micro SD-kaartje klaarmaken voor de Raspberry Pi 3B+</a></li><li><a class="tocitem" href="../chapter2/">2 Communiceren met de Raspberry Pi</a></li><li><a class="tocitem" href="../chapter3/">3 Docker installeren</a></li><li><a class="tocitem" href="../chapter4/">4 Portainer installeren</a></li><li><a class="tocitem" href="../chapter5/">5 Node-RED installeren</a></li></ul></li><li><span class="tocitem">Sectie 2 - Algemene Node-RED toepassingen</span><ul><li><a class="tocitem" href="../chapter6/">6 Website bouwen met Node-RED</a></li></ul></li><li><span class="tocitem">Sectie 3 - Sensoren</span><ul><li class="is-active"><a class="tocitem" href>7 MQTT broker installeren</a><ul class="internal"><li><a class="tocitem" href="#Wat-je-nodig-hebt"><span>Wat je nodig hebt</span></a></li><li><a class="tocitem" href="#Wat-je-gaat-doen"><span>Wat je gaat doen</span></a></li><li><a class="tocitem" href="#Stap-1-ChatGPT-om-docker-compose.yml-bestand-vragen"><span>Stap 1 - ChatGPT om docker-compose.yml bestand vragen</span></a></li><li><a class="tocitem" href="#Stap-2-Installeren-Mosquittto"><span>Stap 2 - Installeren Mosquittto</span></a></li><li><a class="tocitem" href="#Samenvatting"><span>Samenvatting</span></a></li></ul></li><li><a class="tocitem" href="../chapter8/">8 Temperatuur meten</a></li><li><a class="tocitem" href="../chapter9/">9 Node-RED dashboard programma maken</a></li></ul></li><li><span class="tocitem">Sectie 4 - Slimme meter</span><ul><li><a class="tocitem" href="../chapter10/">10 Domoticz installeren</a></li><li><a class="tocitem" href="../chapter11/">11 Slimme meter aansluiten</a></li><li><a class="tocitem" href="../chapter12/">12 Stroom- en gasverbruik op het dashboard weergeven</a></li></ul></li><li><a class="tocitem" href="../appendix/">Bijlage</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Sectie 3 - Sensoren</a></li><li class="is-active"><a href>7 MQTT broker installeren</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>7 MQTT broker installeren</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/rbontekoe/RASPIKIDS/blob/master/docs/src/chapter7.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="MQTT-broker-installeren"><a class="docs-heading-anchor" href="#MQTT-broker-installeren">MQTT broker installeren</a><a id="MQTT-broker-installeren-1"></a><a class="docs-heading-anchor-permalink" href="#MQTT-broker-installeren" title="Permalink"></a></h1><p><em>Een MQTT broker is een programma waarmee we gegevens kunnen uitwisselen tussen verschillende computers of sensoren.</em></p><h3 id="Inhoud"><a class="docs-heading-anchor" href="#Inhoud">Inhoud</a><a id="Inhoud-1"></a><a class="docs-heading-anchor-permalink" href="#Inhoud" title="Permalink"></a></h3><ul><li><a href="#MQTT-broker-installeren">MQTT broker installeren</a></li><li class="no-marker"><ul><li><a href="#Wat-je-nodig-hebt">Wat je nodig hebt</a></li><li><a href="#Wat-je-gaat-doen">Wat je gaat doen</a></li><li><a href="#Stap-1-ChatGPT-om-docker-compose.yml-bestand-vragen">Stap 1 - ChatGPT om docker-compose.yml bestand vragen</a></li><li><a href="#Stap-2-Installeren-Mosquittto">Stap 2 - Installeren Mosquittto</a></li><li><a href="#Samenvatting">Samenvatting</a></li></ul></li></ul><h2 id="Wat-je-nodig-hebt"><a class="docs-heading-anchor" href="#Wat-je-nodig-hebt">Wat je nodig hebt</a><a id="Wat-je-nodig-hebt-1"></a><a class="docs-heading-anchor-permalink" href="#Wat-je-nodig-hebt" title="Permalink"></a></h2><ul><li>Een Raspberry Pi 3B+ met het besturingssysteem Ubuntu Server 22.04.</li><li>Docker, Portainer en Node-RED zijn geinstalleerd.</li></ul><h2 id="Wat-je-gaat-doen"><a class="docs-heading-anchor" href="#Wat-je-gaat-doen">Wat je gaat doen</a><a id="Wat-je-gaat-doen-1"></a><a class="docs-heading-anchor-permalink" href="#Wat-je-gaat-doen" title="Permalink"></a></h2><p>Stap 1: ChatGPT om docker-compose.yml bestand vragen.</p><p>Stap 2: Installeren Mosquittto.</p><p>Stap 3: Toegang aan iedereen geven.</p><h2 id="Stap-1-ChatGPT-om-docker-compose.yml-bestand-vragen"><a class="docs-heading-anchor" href="#Stap-1-ChatGPT-om-docker-compose.yml-bestand-vragen">Stap 1 - ChatGPT om docker-compose.yml bestand vragen</a><a id="Stap-1-ChatGPT-om-docker-compose.yml-bestand-vragen-1"></a><a class="docs-heading-anchor-permalink" href="#Stap-1-ChatGPT-om-docker-compose.yml-bestand-vragen" title="Permalink"></a></h2><p>Stel de volgende vraag aan chatGPT: maak een docker-compose.yml bestand voor mosquitto.</p><p>Ik kreeg als antwoord:</p><h3 id="docker-compose.yml"><a class="docs-heading-anchor" href="#docker-compose.yml">docker-compose.yml</a><a id="docker-compose.yml-1"></a><a class="docs-heading-anchor-permalink" href="#docker-compose.yml" title="Permalink"></a></h3><pre><code class="nohighlight hljs">version: &#39;3&#39;
services:
  mosquitto:
    image: eclipse-mosquitto
    ports:
      - &quot;1883:1883&quot;
    volumes:
      - mosquitto-data:/mosquitto/data
      - mosquitto-config:/mosquitto/config
    restart: unless-stopped

volumes:
  mosquitto-data:
  mosquitto-config:</code></pre><p>Deze configuratie maakt gebruik van de officiële Eclipse Mosquitto Docker-afbeelding (image) en maakt verbinding op poort 1883. Het configureert ook twee Docker-volumes voor de gegevens en configuratie van Mosquitto, zodat deze na het verwijderen van de container behouden blijven.</p><h2 id="Stap-2-Installeren-Mosquittto"><a class="docs-heading-anchor" href="#Stap-2-Installeren-Mosquittto">Stap 2 - Installeren Mosquittto</a><a id="Stap-2-Installeren-Mosquittto-1"></a><a class="docs-heading-anchor-permalink" href="#Stap-2-Installeren-Mosquittto" title="Permalink"></a></h2><table><tr><th style="text-align: left">Stap</th><th style="text-align: left">Actie</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">Kopieeer de gegevens uit <a href="#docker-compose.yml">docker-compose.yml</a> naar het klembord.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">Open de browser en type in de adresbalk: <code>IP-adres_Raspberry_Pi:9000</code>. Dit zorgt dat je Portainer in je browser opent.</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">Zoek in de browser naar &quot;stacks&quot; en klik erop. Hierdoor opent het menu. <span>$\\$</span><img src="../assets/fig_7_1.png" alt="fig_7_1"/></td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">Klik in het menu op &quot;Stacks&quot; om een overzicht te zien. <span>$\\$</span><img src="../assets/fig_7_2.png" alt="fig_7_2"/></td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">Klik op de knop &quot;Add Stack&quot;.</td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">Geef de Stack een naam door <code>mosquitto</code> in het veld &quot;Name&quot; te typen.</td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">Klik op de eerste regel in het veld &quot;Web-editor&quot; en plak de tekst van het klembord door Ctrl + V te drukken. <span>$\\$</span><img src="../assets/fig_7_3.png" alt="fig_7_3"/></td></tr><tr><td style="text-align: left">8</td><td style="text-align: left">Klik op de knop &quot;Deploy the stack&quot; die onderaan de pagina staat.<span>$\\$</span><img src="../assets/fig_7_4.png" alt="fig_7_4"/></td></tr><tr><td style="text-align: left">9</td><td style="text-align: left">Ga naar het menu &quot;containers&quot; en kijk of de container begint .</td></tr><tr><td style="text-align: left"></td><td style="text-align: left"></td></tr></table><p>En dat is het! Je zou nu een werkende Mosquitto MQTT-broker moeten hebben binnen een Docker stack die beheerd wordt door Portainer. </p><h3 id="Stap-3-Toegang-aan-iedereen-geven"><a class="docs-heading-anchor" href="#Stap-3-Toegang-aan-iedereen-geven">Stap 3 - Toegang aan iedereen geven</a><a id="Stap-3-Toegang-aan-iedereen-geven-1"></a><a class="docs-heading-anchor-permalink" href="#Stap-3-Toegang-aan-iedereen-geven" title="Permalink"></a></h3><table><tr><th style="text-align: left">Stap</th><th style="text-align: left">Actie</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">Open het programma Protainer en ga naar &quot;Containers&quot;.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">We gaan iets veranderen in de Mosquitto-instellingen zodat iedereen erbij kan. Klik op het vierde plaatje achter &quot;mosquitto-mosquitto-1&quot; om in de container naar binnen te gaan. <span>$\\$</span><img src="../assets/fig_7_5.png" alt="fig_7_5"/></td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">Kies in het veld &quot;Command&quot; voor &quot;/bin/sh&quot;. Druk op de knop &quot;Connect&quot;. <span>$\\$</span><img src="../assets/fig_7_6.png" alt="fig_7_6"/></td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">Genereer een lijst met folders en de bestanden, typ: <code>ls -l</code>. Je ziet het bestand &quot;mosquitto-no-auth.conf&quot;.</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">Als je wilt weten wat er in het bestand staat, typ dan <code>cat mosquitto-no-auth.conf</code> en druk op de toets &quot;Enter&quot;. De zin &quot;allow_anonymous true&quot; betekent dat je niet hoeft in te loggen. <span>$\\$</span><img src="../assets/fig_7_7.png" alt="fig_7_7"/></td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">We gaan het bestand kopiëren naar de map &quot;/mosquitto/config/&quot;. Typ hiervoor: <code>cp mosquitto-no-auth.conf /mosquitto/config/mosquitto.conf</code>.</td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">Verlaat de contaner met &quot;Ctrl+D&quot;.</td></tr><tr><td style="text-align: left">8</td><td style="text-align: left">Vink het hokje aan voor de container en klik op de knop &quot;Restart&quot;. <span>$\\$</span><img src="../assets/fig_7_8.png" alt="fig_7_8"/></td></tr><tr><td style="text-align: left"></td><td style="text-align: left"></td></tr></table><div class="admonition is-info"><header class="admonition-header">Tip</header><div class="admonition-body"><h4>Auto-complete/Automatisch aanvulling</h4><p>In Linux is er een handige functie die auto-complete heet en die je helpt om sneller en makkelijker commando&#39;s in te typen in de terminal. Stel je voor dat je een lang woord moet typen, zoals &quot;cp mosquitto-no-auth.conf /mosquitto/config/mosquitto.conf&quot;. In plaats van het hele woord te typen, kun je de eerste paar letters typen, zoals &quot;cp mo&quot;, en dan op de tab-toets drukken. Linux zal dan het woord &quot;cp mo&quot; automatisch voor je afmaken als er geen andere woorden zijn die met &quot;mo&quot; beginnen. Als je de tweede keer op de tab-toets drukt, dan krijg je een overzicht van alle mogelijke woorden die beginnen met &quot;mosquitto&quot;. In ons geval zie je dan bijvoorbeeld &quot;mosquitto-no-auth.conf&quot; en &quot;mosquitto/&quot;: <span>$\\$</span>     <img src="../assets/fig_7_9.png" alt="fig_7_9"/></p><p>Als je daarna op de &quot;-&quot; toets drukt gevolgd door de tab-toets, dan maakt Linux het hele woord voor je af. Dit bespaart tijd en voorkomt fouten als je lange woorden moet typen. Auto-complete is dus een handige functie die het werken in de terminal veel makkelijker en sneller maakt.</p><p>Een command breek je af met &quot;Ctrl+C&quot;.</p></div></div><h2 id="Samenvatting"><a class="docs-heading-anchor" href="#Samenvatting">Samenvatting</a><a id="Samenvatting-1"></a><a class="docs-heading-anchor-permalink" href="#Samenvatting" title="Permalink"></a></h2><p>In deze les leer je hoe je Mosquitto installeert, een programma dat helpt bij het delen van informatie tussen verschillende computers en sensoren. Om dit te doen heb je een Raspberry Pi 3B+ met Ubuntu Server 22.04 besturingssysteem nodig en de programma&#39;s Docker, Portainer en Node-RED. Je moet de inhoud van een bestand genaamd &quot;docker-compose.yml&quot; in Portainer plakken om Mosquitto te kunnen installeren. Vervolgens moet je een paar instellingen aanpassen, zodat programma&#39;s niet hoeven in te loggen. Dit doe je door het bestand &quot;mosquitto-no-auth.conf&quot; te kopiëren naar een speciale map en de container opnieuw op te starten. En kijk, je hebt nu een werkende MQTT-broker die informatie kan delen tussen verschillende apparaten!</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../chapter6/">« 6 Website bouwen met Node-RED</a><a class="docs-footer-nextpage" href="../chapter8/">8 Temperatuur meten »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 6 July 2023 16:09">Thursday 6 July 2023</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

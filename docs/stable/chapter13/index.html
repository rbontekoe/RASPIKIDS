<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>13 Grafana en InfluxDB installeren · RASPIKIDS</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="RASPIKIDS logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">RASPIKIDS</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Toepassingen met de Raspberry Pi</a></li><li><a class="tocitem" href="../blog/">Blog</a></li><li><span class="tocitem">Sectie 1 - Basis installaties</span><ul><li><a class="tocitem" href="../chapter1/">1 Micro SD-kaartje klaarmaken voor de Raspberry Pi 3B+</a></li><li><a class="tocitem" href="../chapter2/">2 Communiceren met de Raspberry Pi</a></li><li><a class="tocitem" href="../chapter3/">3 Docker installeren</a></li><li><a class="tocitem" href="../chapter4/">4 Portainer installeren</a></li><li><a class="tocitem" href="../chapter5/">5 Node-RED installeren</a></li></ul></li><li><span class="tocitem">Sectie 2 - Algemene Node-RED toepassingen</span><ul><li><a class="tocitem" href="../chapter6/">6 Website bouwen met Node-RED</a></li></ul></li><li><span class="tocitem">Sectie 3 - Sensoren</span><ul><li><a class="tocitem" href="../chapter7/">7 MQTT broker installeren</a></li><li><a class="tocitem" href="../chapter8/">8 Temperatuur meten</a></li><li><a class="tocitem" href="../chapter9/">9 Node-RED dashboard programma maken</a></li></ul></li><li><span class="tocitem">Sectie 4 - Slimme meter</span><ul><li><a class="tocitem" href="../chapter10/">10 Domoticz installeren</a></li><li><a class="tocitem" href="../chapter11/">11 Slimme meter aansluiten</a></li><li><a class="tocitem" href="../chapter12/">12 Stroom- en gasverbruik op het dashboard weergeven</a></li></ul></li><li><span class="tocitem">Sectie 5 - InfluxDB en Grafana</span><ul><li class="is-active"><a class="tocitem" href>13 Grafana en InfluxDB installeren</a><ul class="internal"><li><a class="tocitem" href="#Wat-je-nodig-hebt"><span>Wat je nodig hebt</span></a></li><li><a class="tocitem" href="#Wat-je-gaat-doen"><span>Wat je gaat doen</span></a></li><li><a class="tocitem" href="#Stap-1-Stack-met-Grafana-en-Influxdb-maken"><span>Stap 1 - Stack met Grafana en Influxdb maken</span></a></li><li><a class="tocitem" href="#Stap-2-Wachtwoord-Grafana-wijzigen"><span>Stap 2 - Wachtwoord Grafana wijzigen</span></a></li><li><a class="tocitem" href="#Stap-3-Grafana-aan-InfluxDB-koppelen"><span>Stap 3 - Grafana aan InfluxDB koppelen</span></a></li><li><a class="tocitem" href="#Samenvatting"><span>Samenvatting</span></a></li></ul></li><li><a class="tocitem" href="../chapter14/">14 Gegevens opslaan in Influx met Node-RED</a></li><li><a class="tocitem" href="../chapter15/">15 Gegevens grafisch weergeven met Grafana</a></li></ul></li><li><a class="tocitem" href="../appendix/">Bijlage</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Sectie 5 - InfluxDB en Grafana</a></li><li class="is-active"><a href>13 Grafana en InfluxDB installeren</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>13 Grafana en InfluxDB installeren</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/rbontekoe/RASPIKIDS/blob/master/docs/src/chapter13.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Grafana-en-InfluxDB-containers-installeren"><a class="docs-heading-anchor" href="#Grafana-en-InfluxDB-containers-installeren">Grafana en InfluxDB containers installeren</a><a id="Grafana-en-InfluxDB-containers-installeren-1"></a><a class="docs-heading-anchor-permalink" href="#Grafana-en-InfluxDB-containers-installeren" title="Permalink"></a></h1><p>*Grafana is een programma dat je kunt gebruiken om gegevens te visualiseren. Stel je voor dat je een lijst hebt met getallen, zoals de temperatuur in een kamer gedurende een dag. Met Grafana kun je deze getallen op een grafiek zetten, zodat je gemakkelijk kunt zien hoe de temperatuur is veranderd gedurende de dag. Zo kun je bijvoorbeeld zien of de temperatuur is gestegen of gedaald, en hoeveel.</p><p>InfluxDB is een programma waarmee je gegevens kunt opslaan en beheren. Stel je voor dat je een lijst hebt met getallen, zoals de temperatuur in een kamer gedurende een week. Met InfluxDB kun je deze getallen opslaan, zodat je ze later weer kunt bekijken. Zo kun je bijvoorbeeld zien hoe de temperatuur is veranderd gedurende een week, en hoeveel.</p><p>Grafana en InfluxDB worden vaak samen gebruikt. Met Grafana kun je de gegevens die in InfluxDB zijn opgeslagen visualiseren, zodat je ze gemakkelijk kunt begrijpen en analyseren. Bijvoorbeeld, als je de temperatuur in een kamer wilt bekijken gedurende een week, kun je de gegevens van de temperatuur in InfluxDB opslaan.*</p><h3 id="Inhoud"><a class="docs-heading-anchor" href="#Inhoud">Inhoud</a><a id="Inhoud-1"></a><a class="docs-heading-anchor-permalink" href="#Inhoud" title="Permalink"></a></h3><ul><li><a href="#Grafana-en-InfluxDB-containers-installeren">Grafana en InfluxDB containers installeren</a></li><li class="no-marker"><ul><li><a href="#Wat-je-nodig-hebt">Wat je nodig hebt</a></li><li><a href="#Wat-je-gaat-doen">Wat je gaat doen</a></li><li><a href="#Stap-1-Stack-met-Grafana-en-Influxdb-maken">Stap 1 - Stack met Grafana en Influxdb maken</a></li><li><a href="#Stap-2-Wachtwoord-Grafana-wijzigen">Stap 2 - Wachtwoord Grafana wijzigen</a></li><li><a href="#Stap-3-Grafana-aan-InfluxDB-koppelen">Stap 3 - Grafana aan InfluxDB koppelen</a></li><li><a href="#Samenvatting">Samenvatting</a></li></ul></li></ul><h2 id="Wat-je-nodig-hebt"><a class="docs-heading-anchor" href="#Wat-je-nodig-hebt">Wat je nodig hebt</a><a id="Wat-je-nodig-hebt-1"></a><a class="docs-heading-anchor-permalink" href="#Wat-je-nodig-hebt" title="Permalink"></a></h2><ul><li>Een Raspberry Pi 3B+ met het besturingssysteem Ubuntu Server 22.04.</li><li>Docker, Portainer en Node-RED zijn geïnstalleerd.</li><li>De Raspberry Pi heeft verbinding met het Internet.</li></ul><h2 id="Wat-je-gaat-doen"><a class="docs-heading-anchor" href="#Wat-je-gaat-doen">Wat je gaat doen</a><a id="Wat-je-gaat-doen-1"></a><a class="docs-heading-anchor-permalink" href="#Wat-je-gaat-doen" title="Permalink"></a></h2><p>Stap 1: Stack met Grafana en Influxdb maken.</p><p>Stap 2: Wachtwoord Grafana wijzigen.</p><p>Stap 3: Grafana aan InfluxDB koppelen.</p><p>Stap 4: Sensor_data database maken.</p><p>Stap 5: Data naar database wegschrijven</p><h2 id="Stap-1-Stack-met-Grafana-en-Influxdb-maken"><a class="docs-heading-anchor" href="#Stap-1-Stack-met-Grafana-en-Influxdb-maken">Stap 1 - Stack met Grafana en Influxdb maken</a><a id="Stap-1-Stack-met-Grafana-en-Influxdb-maken-1"></a><a class="docs-heading-anchor-permalink" href="#Stap-1-Stack-met-Grafana-en-Influxdb-maken" title="Permalink"></a></h2><h3 id="docker-compose.yml"><a class="docs-heading-anchor" href="#docker-compose.yml">docker-compose.yml</a><a id="docker-compose.yml-1"></a><a class="docs-heading-anchor-permalink" href="#docker-compose.yml" title="Permalink"></a></h3><pre><code class="nohighlight hljs">version: &#39;3.6&#39;

services:
  grafana:
    container_name: grafana
    image: grafana/grafana
    restart: unless-stopped
    user: &quot;0&quot;
    ports:
    - &quot;3000:3000&quot;
    environment:
    - TZ=Etc/UTC
    - GF_PATHS_DATA=/var/lib/grafana
    - GF_PATHS_LOGS=/var/log/grafana
    volumes:
    - ./volumes/grafana/data:/var/lib/grafana
    - ./volumes/grafana/log:/var/log/grafana
    healthcheck:
      test: [&quot;CMD&quot;, &quot;wget&quot;, &quot;-O&quot;, &quot;/dev/null&quot;, &quot;http://localhost:3000&quot;]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s

  influxdb:
    container_name: influxdb
    image: &quot;influxdb:1.8&quot;
    restart: unless-stopped
    ports:
    - &quot;8086:8086&quot;
    environment:
    - TZ=Etc/UTC
    - INFLUXDB_HTTP_FLUX_ENABLED=false
    - INFLUXDB_REPORTING_DISABLED=false
    - INFLUXDB_HTTP_AUTH_ENABLED=false
    - INFLUXDB_MONITOR_STORE_ENABLED=FALSE
  # - INFLUX_USERNAME=dba
  # - INFLUX_PASSWORD=supremo
  # - INFLUXDB_UDP_ENABLED=false
  # - INFLUXDB_UDP_BIND_ADDRESS=0.0.0.0:8086
  # - INFLUXDB_UDP_DATABASE=udp
    volumes:
    - ./volumes/influxdb/data:/var/lib/influxdb
    - ./backups/influxdb/db:/var/lib/influxdb/backup
    healthcheck:
      test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;http://localhost:8086&quot;]
      interval: 30s
      timeout: 10s
      retries: 3

      start_period: 30s</code></pre><p>Deze code gaat over twee services die &quot;Grafana&quot; en &quot;InfluxDB&quot; heten.</p><p>Laten we beginnen met Grafana. De &quot;services&quot; sectie vertelt ons dat we een service hebben die Grafana heet. Het gebruikt een &quot;image&quot; genaamd &quot;grafana/grafana&quot;, wat betekent dat het Grafana-pakket van Docker Hub zal worden gebruikt.</p><p>De &quot;restart&quot; sectie vertelt de container om opnieuw op te starten tenzij er een specifieke stopopdracht wordt gegeven. De &quot;user&quot; sectie stelt de gebruiker in de container in op 0, wat betekent dat het als de rootgebruiker wordt uitgevoerd.</p><p>Dan hebben we de &quot;ports&quot; sectie die ons vertelt dat we de poorten 3000:3000 moeten openen, wat betekent dat verkeer naar de poort 3000 van de container zal worden omgeleid naar poort 3000 op de hostmachine.</p><p>De &quot;environment&quot; sectie vertelt ons welke omgevingsvariabelen we moeten instellen. &quot;TZ&quot; is de tijdzone en &quot;GF<em>PATHS</em>DATA&quot; en &quot;GF<em>PATHS</em>LOGS&quot; zijn de paden naar de gegevens- en logbestanden van Grafana. De &quot;volumes&quot; sectie vertelt ons dat we lokale mappen moeten koppelen aan mappen in de container.</p><p>Ten slotte hebben we de &quot;healthcheck&quot; sectie die ons vertelt hoe we kunnen controleren of Grafana correct werkt. Het test de container elke 30 seconden door een opdracht uit te voeren en als de test niet slaagt, zal het nog twee keer proberen voordat het de container als niet-gezond beschouwt.</p><p>InfluxDB volgt een vergelijkbaar formaat als Grafana. We hebben een container genaamd &quot;influxdb&quot; die de &quot;influxdb:1.8&quot; image gebruikt. Het opent poort 8086, stelt enkele omgevingsvariabelen in en koppelt mappen.</p><p>Net als Grafana heeft InfluxDB ook een &quot;healthcheck&quot; sectie die test of de container correct werkt door het elke 30 seconden te testen.</p><h2 id="Stap-2-Wachtwoord-Grafana-wijzigen"><a class="docs-heading-anchor" href="#Stap-2-Wachtwoord-Grafana-wijzigen">Stap 2 - Wachtwoord Grafana wijzigen</a><a id="Stap-2-Wachtwoord-Grafana-wijzigen-1"></a><a class="docs-heading-anchor-permalink" href="#Stap-2-Wachtwoord-Grafana-wijzigen" title="Permalink"></a></h2><p>Als je de eerste keer inlogt, moet je een gebruikersnaam en wachtwoord invullen. De standaard gebruikersnaam is &quot;admin&quot; en het wachtwoord is ook &quot;admin&quot;. Maar het is belangrijk om je wachtwoord te veranderen zodat het veiliger is. Als je inlogt, zal er worden gevraagd of je je wachtwoord wilt veranderen. Zorg ervoor dat je een nieuw en sterk wachtwoord kiest dat niemand anders kan raden.</p><p><img src="../assets/fig_13_1.png" alt="fig_13_1"/></p><h2 id="Stap-3-Grafana-aan-InfluxDB-koppelen"><a class="docs-heading-anchor" href="#Stap-3-Grafana-aan-InfluxDB-koppelen">Stap 3 - Grafana aan InfluxDB koppelen</a><a id="Stap-3-Grafana-aan-InfluxDB-koppelen-1"></a><a class="docs-heading-anchor-permalink" href="#Stap-3-Grafana-aan-InfluxDB-koppelen" title="Permalink"></a></h2><p>Verbreed het menu door op het venster te verbreden door op &quot;&gt;&quot; te klikken. Ga naar &quot;Configuration&quot; en klik op &quot;Data sources&quot;.</p><p><img src="../assets/fig_13_2.png" alt="fig_13_2"/></p><p>Klik op de knop &quot;Add data source&quot;.</p><p><img src="../assets/fig_13_3.png" alt="fig_13_3"/></p><p>Kies voor &quot;InfluxDB&quot;.</p><p><img src="../assets/fig_13_4.png" alt="fig_13_4"/></p><p>Grafana en InfluxDB werken nu samen.</p><h2 id="Samenvatting"><a class="docs-heading-anchor" href="#Samenvatting">Samenvatting</a><a id="Samenvatting-1"></a><a class="docs-heading-anchor-permalink" href="#Samenvatting" title="Permalink"></a></h2><p>Grafana en InfluxDB zijn programma&#39;s die samen kunnen worden gebruikt om gegevens te visualiseren en op te slaan. Grafana helpt om deze gegevens op een grafiek te zetten, terwijl InfluxDB helpt om deze gegevens op te slaan en te beheren. De installatie van deze programma&#39;s kan worden gedaan door het uitvoeren van een aantal stappen op een Raspberry Pi 3B+ met het Ubuntu Server-besturingssysteem. Deze stappen omvatten het maken van een stapel met Grafana en InfluxDB, het wijzigen van het wachtwoord van Grafana en het koppelen van Grafana aan InfluxDB. De code toont de instellingen voor de containerdiensten Grafana en InfluxDB.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../chapter12/">« 12 Stroom- en gasverbruik op het dashboard weergeven</a><a class="docs-footer-nextpage" href="../chapter14/">14 Gegevens opslaan in Influx met Node-RED »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Wednesday 3 May 2023 12:07">Wednesday 3 May 2023</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Gegevens opslaan in een Influx database met Node-RED · RASPIKIDS</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="RASPIKIDS logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">RASPIKIDS</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Toepassingen met de Raspberry Pi</a></li><li><a class="tocitem" href="../blog/">Blog</a></li><li><span class="tocitem">Sectie 1 - Basis installaties</span><ul><li><a class="tocitem" href="../chapter1/">1 Micro SD-kaartje klaarmaken voor de Raspberry Pi 3B+</a></li><li><a class="tocitem" href="../chapter2/">2 Communiceren met de Raspberry Pi</a></li><li><a class="tocitem" href="../chapter3/">3 Docker installeren</a></li><li><a class="tocitem" href="../chapter4/">4 Portainer installeren</a></li><li><a class="tocitem" href="../chapter5/">5 Node-RED installeren</a></li></ul></li><li><span class="tocitem">Sectie 2 - Algemene Node-RED toepassingen</span><ul><li><a class="tocitem" href="../chapter6/">6 Website bouwen met Node-RED</a></li></ul></li><li><span class="tocitem">Sectie 3 - Sensoren</span><ul><li><a class="tocitem" href="../chapter7/">7 MQTT broker installeren</a></li><li><a class="tocitem" href="../chapter8/">8 Temperatuur meten</a></li><li><a class="tocitem" href="../chapter9/">9 Node-RED dashboard programma maken</a></li></ul></li><li><span class="tocitem">Sectie 4 - Slimme meter</span><ul><li><a class="tocitem" href="../chapter10/">10 Domoticz installeren</a></li><li><a class="tocitem" href="../chapter11/">11 Slimme meter aansluiten</a></li><li><a class="tocitem" href="../chapter12/">12 Stroom- en gasverbruik op het dashboard weergeven</a></li></ul></li><li><a class="tocitem" href="../appendix/">Bijlage</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Gegevens opslaan in een Influx database met Node-RED</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Gegevens opslaan in een Influx database met Node-RED</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/rbontekoe/RASPIKIDS/blob/master/docs/src/chapter14.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Gegevens-opslaan-in-een-Influx-database-met-Node-RED"><a class="docs-heading-anchor" href="#Gegevens-opslaan-in-een-Influx-database-met-Node-RED">Gegevens opslaan in een Influx database met Node-RED</a><a id="Gegevens-opslaan-in-een-Influx-database-met-Node-RED-1"></a><a class="docs-heading-anchor-permalink" href="#Gegevens-opslaan-in-een-Influx-database-met-Node-RED" title="Permalink"></a></h1><p><em>In dit hoofdstuk leer je hoe je gegevens kunt opslaan in een speciaal programma genaamd Influx database. Dit programma is gemaakt om gegevens te bewaren, zoals bijvoorbeeld temperaturen of vochtigheid. We gebruiken Node-RED om de gegevens naar de Influx database te sturen. Zo kunnen we de gegevens later gemakkelijk terugvinden en bekijken.</em></p><h3 id="Inhoud"><a class="docs-heading-anchor" href="#Inhoud">Inhoud</a><a id="Inhoud-1"></a><a class="docs-heading-anchor-permalink" href="#Inhoud" title="Permalink"></a></h3><ul><li><a href="#Gegevens-opslaan-in-een-Influx-database-met-Node-RED">Gegevens opslaan in een Influx database met Node-RED</a></li><li class="no-marker"><ul><li><a href="#Wat-je-nodig-hebt">Wat je nodig hebt</a></li><li><a href="#Wat-je-gaat-doen">Wat je gaat doen</a></li><li><a href="#Stap-1-InfluxDB-module-in-Node-RED-maken">Stap 1 - InfluxDB module in Node-RED maken</a></li><li><a href="#Stap-2-Sensor_data-database-maken">Stap 2 - Sensor_data database maken</a></li><li><a href="#Stap-3-Data-naar-database-wegschrijven">Stap 3 - Data naar database wegschrijven</a></li><li><a href="#Samenvatting">Samenvatting</a></li></ul></li></ul><h2 id="Wat-je-nodig-hebt"><a class="docs-heading-anchor" href="#Wat-je-nodig-hebt">Wat je nodig hebt</a><a id="Wat-je-nodig-hebt-1"></a><a class="docs-heading-anchor-permalink" href="#Wat-je-nodig-hebt" title="Permalink"></a></h2><ul><li>Een Raspberry Pi 3B+ met het besturingssysteem Ubuntu Server 22.04.</li><li>Docker, Portainer, Node-RED, InfluxDB en Grafana zijn geïnstalleerd.</li><li>Node-RED programma uit de les 9 <a href="../chapter9/index.html">Node-RED dashboard programma maken</a>.</li><li>De Raspberry Pi heeft verbinding met het Internet.</li></ul><h2 id="Wat-je-gaat-doen"><a class="docs-heading-anchor" href="#Wat-je-gaat-doen">Wat je gaat doen</a><a id="Wat-je-gaat-doen-1"></a><a class="docs-heading-anchor-permalink" href="#Wat-je-gaat-doen" title="Permalink"></a></h2><p>Stap 1: InfluxDB module in Node-RED maken.</p><p>Stap 2: Sensor_data database maken.</p><p>Stap 3: Data naar database wegschrijven</p><h2 id="Stap-1-InfluxDB-module-in-Node-RED-maken"><a class="docs-heading-anchor" href="#Stap-1-InfluxDB-module-in-Node-RED-maken">Stap 1 - InfluxDB module in Node-RED maken</a><a id="Stap-1-InfluxDB-module-in-Node-RED-maken-1"></a><a class="docs-heading-anchor-permalink" href="#Stap-1-InfluxDB-module-in-Node-RED-maken" title="Permalink"></a></h2><table><tr><th style="text-align: left">Stap</th><th style="text-align: left">Actie</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">Open de webinterface van Node-RED met <code>IP_adres_Raspberry_Pi:1880</code>.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">Kies uit het menu voor &quot;Manage palette&quot;.</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">Klik op de &quot;Install&quot; tab en zoek naar &quot;node-red-contrib-influxdb&quot;. <span>$//$</span><img src="../assets/fig_14_4.png" alt="fig_14_4"/></td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">Druk op de knop &quot;Install&quot;.</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">In het Node-RED menu vind je de drie knooppunten: <span>$\\$</span><img src="../assets/fig_14_6.png" alt="fig_14_6"/></td></tr><tr><td style="text-align: left"></td><td style="text-align: left"></td></tr></table><h2 id="Stap-2-Sensor_data-database-maken"><a class="docs-heading-anchor" href="#Stap-2-Sensor_data-database-maken">Stap 2 - Sensor_data database maken</a><a id="Stap-2-Sensor_data-database-maken-1"></a><a class="docs-heading-anchor-permalink" href="#Stap-2-Sensor_data-database-maken" title="Permalink"></a></h2><table><tr><th style="text-align: left">Stap</th><th style="text-align: left">Actie</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">Ga naar de webinterface van Portainer en login: &quot;IP<em>adres</em>Raspberry_Pi:9000&quot;.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">Klik op &quot;&gt;_&quot; symbool van de influxdb container. <span>$\\$</span><img src="../assets/fig_14_7.png" alt="fig_14_7"/></td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">Druk op de knop: &quot;Connect&quot;. <span>$\\$</span><img src="../assets/fig_14_8.png" alt="fig_14_8"/></td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">Om de datum als &quot;jjjj-mm-dd&quot; weer te geven, typ: <code>influx -precision &#39;rfc3339&#39;</code> en druk op Enter.</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">Om de database &quot;sensor_data&quot; te maken, typ: <code>create database sensor_data</code> en druk op Enter.</td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">Verlaat de database interface met Ctrl-D.</td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">Verlaat de container interface met Ctrl_D.</td></tr><tr><td style="text-align: left"></td><td style="text-align: left"></td></tr></table><h2 id="Stap-3-Data-naar-database-wegschrijven"><a class="docs-heading-anchor" href="#Stap-3-Data-naar-database-wegschrijven">Stap 3 - Data naar database wegschrijven</a><a id="Stap-3-Data-naar-database-wegschrijven-1"></a><a class="docs-heading-anchor-permalink" href="#Stap-3-Data-naar-database-wegschrijven" title="Permalink"></a></h2><table><tr><th style="text-align: left">Stap</th><th style="text-align: left">Actie</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">Open Node-RED.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">Sleep een <code>function</code> en het <code>influx out</code> knooppunt naar je werkblad en verbind de knooppunten volgens het schema. <span>$\\$</span><img src="../assets/fig_14_9.png" alt="fig_14_9"/></td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">Open het <code>function</code> knooppunt en type de volgende code. <span>$\\$</span><img src="../assets/fig_14_10.png" alt="fig_14_10"/></td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">Druk op de toets &quot;Done&quot;.</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">Open het <code>influx out</code> knooppunt.</td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">Klik op het &quot;potloodje&quot;. <span>$\\$</span><img src="../assets/fig_14_11.png" alt="fig_14_11"/> <span>$\\$</span>In Node-RED: JSON object creeert de tabel &quot;test&quot;, die staat gedefinieerd in het knooppunt &quot;influxdb out&quot; onder &quot;Measurments&quot;. Aantal items bepaalt aantal kolommen, naast de eerste kolom die datum en tijd bevat:</td></tr></table><pre><code class="nohighlight hljs">      {
          temp: Number(myval),   // de meting
          type: &quot;temp&quot;,          // extra informatie
          locatie: &quot;LR&quot;          // extra informatie
      }</code></pre><table><tr><th style="text-align: left">Stap</th><th style="text-align: left">Actie</th></tr><tr><td style="text-align: left">7</td><td style="text-align: left">Vul het ip adres van je Raspberry Pi in en geef als naam van de database sensor_data op. <img src="../assets/fig_14_12.png" alt="fig_14_12"/></td></tr><tr><td style="text-align: left">8</td><td style="text-align: left">Druk op de knop &quot;Update&quot;.</td></tr><tr><td style="text-align: left">9</td><td style="text-align: left">Druk op de knop &quot;Done&quot;.</td></tr><tr><td style="text-align: left">10</td><td style="text-align: left">Druk op de knop &quot;Deploy&quot;.</td></tr><tr><td style="text-align: left"></td><td style="text-align: left"></td></tr></table><p>Open de container interface en open de database interface met <code>influx -precision &#39;rfc3339&#39; # datum in yyyy-mm-dd formaat</code></p><p>Open database en typ <code>use sensor_data</code> en daarna `select * from test. Je krijg het volgende te zien:</p><pre><code class="nohighlight hljs">2023-03-02T13:10:05.228259851Z buiten  10   temp
2023-03-02T13:40:05.289277559Z buiten  10.1 temp
2023-03-02T14:10:05.322618876Z buiten  10.1 temp</code></pre><h2 id="Samenvatting"><a class="docs-heading-anchor" href="#Samenvatting">Samenvatting</a><a id="Samenvatting-1"></a><a class="docs-heading-anchor-permalink" href="#Samenvatting" title="Permalink"></a></h2><p>In deze les leer je hoe je gegevens zoals temperaturen en vochtigheid kunt opslaan in een Influx database met behulp van Node-RED. Om dit te doen heb je een Raspberry Pi 3B+ nodig met Docker, Portainer, Node-RED, InfluxDB en Grafana. Je moet ook het Node-RED dashboard programma hebben gemaakt en de Raspberry Pi moet verbinding hebben met het internet. Er zijn drie stappen om gegevens naar de Influx database te sturen: 1) een InfluxDB-module in Node-RED maken, 2) een sensor<em>data database maken, en 3) de data naar de database wegschrijven. Om deze stappen uit te voeren moet je verschillende acties ondernemen, zoals het openen van de webinterface van Node-RED, het zoeken naar de node-red-contrib-influxdb en het maken van een database. Je moet ook een functie- en influx-out knooppunt slepen naar je werkblad en deze verbinden volgens het schema. Ten slotte moet je het IP-adres van je Raspberry Pi invoeren en de naam van de database sensor</em>data opgeven, en daarna op de knop &#39;Deploy&#39; drukken. Als je alles goed hebt gedaan, kun je later de gegevens gemakkelijk terugvinden en bekijken.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 6 July 2023 16:09">Thursday 6 July 2023</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

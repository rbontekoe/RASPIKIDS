<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>9 Node-RED dashboard programma maken · RASPIKIDS</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="RASPIKIDS logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">RASPIKIDS</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Toepassingen met de Raspberry Pi</a></li><li><a class="tocitem" href="../blog/">Blog</a></li><li><span class="tocitem">Sectie 1 - Basis installaties</span><ul><li><a class="tocitem" href="../chapter1/">1 Micro SD-kaartje klaarmaken voor de Raspberry Pi 3B+</a></li><li><a class="tocitem" href="../chapter2/">2 Communiceren met de Raspberry Pi</a></li><li><a class="tocitem" href="../chapter3/">3 Docker installeren</a></li><li><a class="tocitem" href="../chapter4/">4 Portainer installeren</a></li><li><a class="tocitem" href="../chapter5/">5 Node-RED installeren</a></li></ul></li><li><span class="tocitem">Sectie 2 - Algemene Node-RED toepassingen</span><ul><li><a class="tocitem" href="../chapter6/">6 Website bouwen met Node-RED</a></li></ul></li><li><span class="tocitem">Sectie 3 - Sensoren</span><ul><li><a class="tocitem" href="../chapter7/">7 MQTT broker installeren</a></li><li><a class="tocitem" href="../chapter8/">8 Temperatuur meten</a></li><li class="is-active"><a class="tocitem" href>9 Node-RED dashboard programma maken</a><ul class="internal"><li><a class="tocitem" href="#Wat-je-nodig-hebt"><span>Wat je nodig hebt</span></a></li><li><a class="tocitem" href="#Wat-je-gaat-doen"><span>Wat je gaat doen</span></a></li><li><a class="tocitem" href="#Stap-1-De-Node-RED-Dashboard-module-downloaden"><span>Stap 1 - De Node-RED Dashboard module downloaden</span></a></li><li><a class="tocitem" href="#Stap-2-Indeling-van-een-dashoard"><span>Stap 2 - Indeling van een dashoard</span></a></li><li><a class="tocitem" href="#Stap-3-Het-dashboard-samenstellen"><span>Stap 3 - Het dashboard samenstellen</span></a></li><li><a class="tocitem" href="#Stap-4-Weergegevens-ophalen-en-op-dashboard-weergeven"><span>Stap 4 - Weergegevens ophalen en op dashboard weergeven</span></a></li><li><a class="tocitem" href="#Samenvatting"><span>Samenvatting</span></a></li></ul></li></ul></li><li><span class="tocitem">Sectie 4 - Slimme meter</span><ul><li><a class="tocitem" href="../chapter10/">10 Domoticz installeren</a></li><li><a class="tocitem" href="../chapter11/">11 Slimme meter aansluiten</a></li><li><a class="tocitem" href="../chapter12/">12 Stroom- en gasverbruik op het dashboard weergeven</a></li></ul></li><li><a class="tocitem" href="../appendix/">Bijlage</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Sectie 3 - Sensoren</a></li><li class="is-active"><a href>9 Node-RED dashboard programma maken</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>9 Node-RED dashboard programma maken</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/rbontekoe/RASPIKIDS/blob/master/docs/src/chapter9.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Node-RED-dashboard-programma-maken"><a class="docs-heading-anchor" href="#Node-RED-dashboard-programma-maken">Node-RED dashboard programma maken</a><a id="Node-RED-dashboard-programma-maken-1"></a><a class="docs-heading-anchor-permalink" href="#Node-RED-dashboard-programma-maken" title="Permalink"></a></h1><p>Deze module geeft je een set knooppunten in <a href="https://flows.nodered.org/node/node-red-dashboard">Node-RED</a> waarmee je snel een live data dashboard kunt maken.</p><p>Je gaat een dashboard maken dat de volgende dingen laat zien:</p><ul><li>Hoe warm het is en hoe vochtig de lucht in huis is.</li><li>Hoe de temperatuur buiten verandert.</li><li>Hoe hard de wind waait en vanuit welke richting.</li></ul><p><img src="../assets/fig_9_20.png" alt="UI"/></p><h3 id="Inhoud"><a class="docs-heading-anchor" href="#Inhoud">Inhoud</a><a id="Inhoud-1"></a><a class="docs-heading-anchor-permalink" href="#Inhoud" title="Permalink"></a></h3><ul><li><a href="#Node-RED-dashboard-programma-maken">Node-RED dashboard programma maken</a></li><li class="no-marker"><ul><li><a href="#Wat-je-nodig-hebt">Wat je nodig hebt</a></li><li><a href="#Wat-je-gaat-doen">Wat je gaat doen</a></li><li><a href="#Stap-1-De-Node-RED-Dashboard-module-downloaden">Stap 1 - De Node-RED Dashboard module downloaden</a></li><li><a href="#Stap-2-Indeling-van-een-dashoard">Stap 2 - Indeling van een dashoard</a></li><li><a href="#Stap-3-Het-dashboard-samenstellen">Stap 3 - Het dashboard samenstellen</a></li><li><a href="#Stap-4-Weergegevens-ophalen-en-op-dashboard-weergeven">Stap 4 - Weergegevens ophalen en op dashboard weergeven</a></li><li><a href="#Samenvatting">Samenvatting</a></li></ul></li></ul><h2 id="Wat-je-nodig-hebt"><a class="docs-heading-anchor" href="#Wat-je-nodig-hebt">Wat je nodig hebt</a><a id="Wat-je-nodig-hebt-1"></a><a class="docs-heading-anchor-permalink" href="#Wat-je-nodig-hebt" title="Permalink"></a></h2><ul><li>Een Raspberry Pi 3B+ met het besturingssysteem Ubuntu Server 22.04.</li><li>Docker, Portainer, Node-RED en MQTT broker zijn geinstalleerd.</li><li>Een ESP8266 met een DHT22 die gegevens stuurt naar de MQTT broker.</li><li>Een wifi netwerk waar de hierboven genoemde delen op zijn aangesloten.</li></ul><h2 id="Wat-je-gaat-doen"><a class="docs-heading-anchor" href="#Wat-je-gaat-doen">Wat je gaat doen</a><a id="Wat-je-gaat-doen-1"></a><a class="docs-heading-anchor-permalink" href="#Wat-je-gaat-doen" title="Permalink"></a></h2><p>Stap 1: De Node-RED Dashboard module downloaden.</p><p>Stap 2: Indeling van een dashboard.</p><p>Stap 3: Het dashboard samenstellen.</p><p>Stap 4: Weergegevens ophalen en op dashboard weergeven.</p><h2 id="Stap-1-De-Node-RED-Dashboard-module-downloaden"><a class="docs-heading-anchor" href="#Stap-1-De-Node-RED-Dashboard-module-downloaden">Stap 1 - De Node-RED Dashboard module downloaden</a><a id="Stap-1-De-Node-RED-Dashboard-module-downloaden-1"></a><a class="docs-heading-anchor-permalink" href="#Stap-1-De-Node-RED-Dashboard-module-downloaden" title="Permalink"></a></h2><p>Node-RED heeft al veel verschillende knooppunten om te gebruiken, maar soms wil je nog meer. Dan kun je nieuwe onderdelen toevoegen. Een handige toevoeging is de <a href="https://flows.nodered.org/node/node-red-dashboard">dashboard</a> module. Deze module bestaat uit verschillende onderdelen die speciaal zijn gemaakt om een dashboard te maken. Bijvoorbeeld, er is een onderdeel om een metertje te maken of om gegevens in een grafiek te laten zien. Ook is er een onderdeel om gegevens als tekst weer te geven. Je moet de module wel zelf toevoegen, want het zit niet automatisch al in Node-RED.</p><table><tr><th style="text-align: left">Stap</th><th style="text-align: left">Actie</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">Als je naar &quot;Manage Palette&quot; wilt gaan, kun je op het menu klikken dat in de rechterbovenhoek van het scherm staat. Of je kunt de toetsen Shift + Alt + P indrukken.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">Ga naar de &quot;Install&quot; tab en zoek naar &quot;node-red-dashboard&quot; in de zoekbalk.</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">Als je de dashboard onderdelen wilt krijgen, moet je op de witte knop met &quot;Install&quot; erop klikken. <span>$\\$</span><img src="../assets/fig_9_28.png" alt="fig_9_22"/></td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">Je ziet een berichtje op je scherm. Druk op de rode knop waar &quot;Install&quot; op staat om de dashboard onderdelen te krijgen. <span>$\\$</span><img src="../assets/fig_9_27.png" alt="fig_9_22"/></td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">Klik op de toets &quot;Close&quot;.</td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">Als je de dashboard onderdelen hebt geïnstalleerd, kun je ze vinden in het linkermenu onder het kopje &quot;dashboard&quot;.</td></tr><tr><td style="text-align: left"></td><td style="text-align: left"></td></tr></table><h2 id="Stap-2-Indeling-van-een-dashoard"><a class="docs-heading-anchor" href="#Stap-2-Indeling-van-een-dashoard">Stap 2 - Indeling van een dashoard</a><a id="Stap-2-Indeling-van-een-dashoard-1"></a><a class="docs-heading-anchor-permalink" href="#Stap-2-Indeling-van-een-dashoard" title="Permalink"></a></h2><p>Een dashboard kan bestaan uit verschillende tabs. Een tab kan verschillende groepen of secties hebben. Het is goed om hierover vooraf al een beeld te vormen.</p><p>Een gebruiker kan maar één tab actief hebben. </p><p>Ons dashboard bestaat uit de tabs en groepen:</p><ul><li>Binnen<ul><li>Woonkamer</li><li>Kamer van Rob</li></ul></li><li>Buiten<ul><li>Leusden</li></ul></li></ul><p>Opzetten van de structuur.</p><table><tr><th style="text-align: left">Stap</th><th style="text-align: left">Actie</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">Druk op de laatste tab rechts en kies voor &quot;Dashboard&quot;. <span>$\\$</span><img src="../assets/fig_9_18.png" alt="fig_9_18"/></td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">Klik in de groep &quot;Tab &amp; Links&quot; op de tab &quot;+tab&quot;. <span>$\\$</span><img src="../assets/fig_9_19.png" alt="fig_9_19"/></td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">Druk op de &quot;edit&quot; knop om de tab te openen. <span>$\\$</span><img src="../assets/fig_9_21.png" alt="fig_9_20"/></td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">Verander de naam van de tab in: &quot;Binnen&quot;.</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">Maak nog een tab aan en noem die &quot;Buiten&quot;</td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">Selecteer de tab &quot;Binnen&quot; en klik op &quot;+group&quot;.</td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">Klik op de &quot;edit&quot; knop am de groep te openen.</td></tr><tr><td style="text-align: left">8</td><td style="text-align: left">Noem de groep &quot;Huiskamer&quot;.</td></tr><tr><td style="text-align: left">9</td><td style="text-align: left">Druk opde toets &quot;Update&quot;.</td></tr><tr><td style="text-align: left">10</td><td style="text-align: left">Herhaal stap 6 en 7 en noem de groep &quot;Kamer van Rob&quot;.</td></tr><tr><td style="text-align: left">11</td><td style="text-align: left">Druk opde toets &quot;Update&quot;.</td></tr><tr><td style="text-align: left">12</td><td style="text-align: left">Klik op de tab &quot;Buiten&quot; en klik op &quot;+group&quot;.</td></tr><tr><td style="text-align: left">13</td><td style="text-align: left">Klik op de &quot;edit&quot; knop om de groep te openen.</td></tr><tr><td style="text-align: left">14</td><td style="text-align: left">Noen de groep &quot;Leusden&quot;.</td></tr><tr><td style="text-align: left">11</td><td style="text-align: left">Druk opde toets &quot;Update&quot;. <span>$\\$</span><img src="../assets/fig_9_31.png" alt="fig_9_31"/> <span>$\\$</span><em>Eindresultaat dashboard</em></td></tr><tr><td style="text-align: left"></td><td style="text-align: left"></td></tr></table><h2 id="Stap-3-Het-dashboard-samenstellen"><a class="docs-heading-anchor" href="#Stap-3-Het-dashboard-samenstellen">Stap 3 - Het dashboard samenstellen</a><a id="Stap-3-Het-dashboard-samenstellen-1"></a><a class="docs-heading-anchor-permalink" href="#Stap-3-Het-dashboard-samenstellen" title="Permalink"></a></h2><p>Als je het adres <code>IP_adres_raspberry_pi:1880/ui</code> intypt in je web browser, kan je gegevens zien van de &quot;dashboard module&quot;. We zullen verwijzen naar de MQTT broker met het onderwerp (topic) &quot;temperatuur2&quot;. <img src="../assets/fig_9_3.png" alt="UI"/>.</p><p>Volg deze stappen om het werk te doen:</p><table><tr><th style="text-align: left">Stap</th><th style="text-align: left">Actie</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">Pak de een &quot;mqtt in&quot; en een &quot;gauge&quot; knooppunt en zet ze op je werkblad.</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">Verbind de het &quot;mqtt in&quot; knooppunt met het &quot;gauge&quot; knooppunt.</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">Dubbelklik op &quot;mqtt in&quot; en klik op het potloodje achter het veld &quot;Server&quot;. <strong>Een nieuw venster wordt geopend</strong>. <span>$\\$</span><img src="../assets/fig_9_30.png" alt="fig_9_22"/></td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">Typ het IP adres van je Raspberry Pi in het vak &quot;Server&quot;. Het poortnummer &quot;1883&quot; wordt automatisch toegevoegd. <strong>Klik op de knop &quot;Add&quot;</strong>. <span>$\\$</span><img src="../assets/fig_9_29.png" alt="fig_9_29"/></td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">Typ <code>temperature2</code> in het &quot;Topic&quot; vak van het &quot;mqtt in&quot; knooppunt. <span>$\\$</span><img src="../assets/fig_9_22.png" alt="fig_9_22"/></td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">Typ <code>Temp huiskamer</code> in het &quot;Name&quot; vak van het &quot;gauge&quot; knooppunt. <span>$\\$</span><img src="../assets/fig_9_23.png" alt="fig_9_23"/></td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">Klik op de toets &quot;Done&quot;.</td></tr><tr><td style="text-align: left">8</td><td style="text-align: left">Dubbelklik op het &quot;gauge&quot; knooppunt. Vul het in volgens onderstaand figuur. <span>$\\$</span><img src="../assets/fig_9_32.png" alt="fig_9_32"/></td></tr><tr><td style="text-align: left">9</td><td style="text-align: left">Klik op de toets &quot;Done&quot;.</td></tr><tr><td style="text-align: left">10</td><td style="text-align: left">Pak opnieuw een &quot;mqtt in&quot; en een &quot;text&quot; knooppunt en zet ze op je werkblad.</td></tr><tr><td style="text-align: left">11</td><td style="text-align: left">Verbind de &quot;mqtt in&quot; knooppunt met het &quot;text&quot; knooppunt.</td></tr><tr><td style="text-align: left">12</td><td style="text-align: left">Het IP adres van je Raspberry Pi staat al goed in het &quot;Server&quot; vak van het &quot;mqtt in&quot; knooppunt.</td></tr><tr><td style="text-align: left">13</td><td style="text-align: left">Typ <code>humidity2</code> in het &quot;Topic&quot; vak van het &quot;mqtt in&quot;.</td></tr><tr><td style="text-align: left">14</td><td style="text-align: left">Typ <code>Hum huiskamer</code> in het &quot;Name&quot; vak van de &quot;mqtt in&quot;.</td></tr><tr><td style="text-align: left">15</td><td style="text-align: left">Klik op &quot;Done&quot;.</td></tr><tr><td style="text-align: left">16</td><td style="text-align: left">Dubbelklik op &quot;text&quot; en Vul het in volgens onderstaand figuur. <span>$\\$</span><img src="../assets/fig_9_24.png" alt="fig_9_24"/>.</td></tr><tr><td style="text-align: left">17</td><td style="text-align: left">Kies het vierde voorbeeld bij &quot;Layout&quot;.</td></tr><tr><td style="text-align: left">18</td><td style="text-align: left">Klik op &quot;Done&quot;.</td></tr><tr><td style="text-align: left">19</td><td style="text-align: left">Klik op de &quot;Deploy&quot; knop om alles in te stellen.</td></tr><tr><td style="text-align: left">20</td><td style="text-align: left">Typ <code>IP_adres_raspberry_pi:1880/ui</code> in de adresbalk van je browser en druk op Enter om de informatie te zien. <span>$\\$</span><img src="../assets/fig_9_25.png" alt="fig_9_22"/></td></tr><tr><td style="text-align: left"></td><td style="text-align: left"></td></tr></table><h2 id="Stap-4-Weergegevens-ophalen-en-op-dashboard-weergeven"><a class="docs-heading-anchor" href="#Stap-4-Weergegevens-ophalen-en-op-dashboard-weergeven">Stap 4 - Weergegevens ophalen en op dashboard weergeven</a><a id="Stap-4-Weergegevens-ophalen-en-op-dashboard-weergeven-1"></a><a class="docs-heading-anchor-permalink" href="#Stap-4-Weergegevens-ophalen-en-op-dashboard-weergeven" title="Permalink"></a></h2><p>We gaan weergegevens over Leusden ophalen van een website die &quot;Visual Crossing&quot; heet. Hiervoor moeten we eerst een account maken op de website. Als we een account hebben, krijgen we een &quot;API key&quot;. Dit is een soort code die we nodig hebben om de informatie op te halen. We hebben in onze les &quot;Website bouwen met Node-RED&quot; al geleerd hoe je met een API omgaat. We mogen de informatie gratis opvragen, maar we moeten er wel voor zorgen dat we niet te vaak op een dag informatie opvragen. Als we het opvragen van informatie onder de 1000 keer per dag houden, is het gratis. Ik vraag zelf de informatie elke 15 minuten op, dus ik vraag het in totaal 4 x 24 = 96 keer per dag op, dus veel minder dan het maximum.</p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Zorg dat je je persoonlijke &quot;API key&quot; klaar hebt liggen voordat je de steppen gaat uitvoeren.</p></div></div><table><tr><th style="text-align: left">Stap</th><th style="text-align: left">Actie</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">Sleep de knooppunten &quot;inject&quot;, &quot;http request&quot;, &quot;debug&quot;, 3x &quot;function&quot; en uit de groep dashboard &quot;chart&quot; en 3x &quot;text&quot;. Confiugreer de knooppunten volgens onderstaand schema. <span>$\\$</span><img src="../assets/fig_9_4.png" alt="schema"/></td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">Dubbelkik op &quot;timestamp&quot; <span>$\\$</span><img src="../assets/fig_9_5.png" alt="fig_9_5 timestamp"/></td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">Klik op het keuzevakje <code>inject once after</code>.</td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">Kies bij de Repeat groep voor: <code>interval</code>.</td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">Type in het veld &quot;every&quot;: <code>30</code>.</td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">Kies als eenheid: <code>minutes</code>.</td></tr><tr><td style="text-align: left">7</td><td style="text-align: left">Druk op de toets &quot;Done&quot;.</td></tr><tr><td style="text-align: left">8</td><td style="text-align: left">Dubbelklik op &quot;http request&quot;. <span>$\\$</span><img src="../assets/fig_9_6.png" alt="fig_9_6 visual crossing"/></td></tr><tr><td style="text-align: left">9</td><td style="text-align: left">Type in het veld &quot;URL&quot;: https://weather.visualcrossing.com/VisualCrossingWebServices/rest/services/timeline/Leusden?unitGroup=metric&amp;key=<strong>JOUW_API_KEY</strong>&amp;contentType=json</td></tr><tr><td style="text-align: left">10</td><td style="text-align: left">Kies in het keuze veld &quot;Return&quot; voor: <code>a parsed JSON object</code>.</td></tr><tr><td style="text-align: left">11</td><td style="text-align: left">Druk op de toets &quot;Done&quot;.</td></tr><tr><td style="text-align: left">12</td><td style="text-align: left">Debug ontvangt van het knooppunt &quot;visualcrossing&quot; een JSON object zodra je op het meest linkse grijze vierkantje klikt van timestamp (en eerst op &quot;Deploy&quot; hebt gedrukt). Een subgroep is &quot;currentConditions&quot;. Dit bevat de gegevens die we willen gebruiken op het dashboard. Je krijgt ze te zien als je in het venster geheel rechts kies voor de derde tab van links &quot;Debug messages&quot;. <span>$\\$</span><img src="../assets/fig_9_16.png" alt="fig_9_16"/><span>$\\$</span><em>Klik op het driehoekjes om het volledige JSON object te bekijken.</em></td></tr><tr><td style="text-align: left">13</td><td style="text-align: left">Dubbelklik op de eerste &quot;functie&quot; en geef het de naam: <code>buitentemp</code>. <span>$\\$</span><img src="../assets/fig_9_7.png" alt="get_actual_temp"/> <span>$\\$</span><em>Wat je hier ziet is JavaScript code. Elke uitdukking eindigt met een &quot;;&quot;. Iets ingesloten door accolades {...} verwijst naar een JSON-object.</em></td></tr><tr><td style="text-align: left">14</td><td style="text-align: left">Typ op de eerste regel: <code>return { payload : msg.payload.currentConditions.temp };</code>. &quot;temp&quot; is de buitentemperatuur. <span>$\\$</span>Een payload is een belangrijk onderdeel van computers en technologie. Het is een term die gebruikt wordt om iets te beschrijven dat wordt verstuurd via internet, een computer-netwerk of in ons geval in een Node-RED flow. Denk bijvoorbeeld aan het versturen van een e-mail naar iemand. De boodschap die je verstuurt, bijvoorbeeld je tekst en eventuele afbeeldingen, is de payload. Het wordt verzonden via het internet naar de ontvanger, zoals jij wilt dat het wordt ontvangen. <span>$\\$</span>Met &quot;msg.payload&quot; wordt verwezen naar het bericht dat Visual Crossing verzendt. Het vervolg &quot;.currentConditions.temp&quot; verwijst naar de buitentemperatuur. <span>$\\$</span><img src="../assets/fig_9_17.png" alt="fig_9_17"/></td></tr><tr><td style="text-align: left">14</td><td style="text-align: left">Druk op de toets &quot;Done&quot;.</td></tr><tr><td style="text-align: left">15</td><td style="text-align: left">Dubbelklik op de tweede &quot;functie&quot; en geef het de naam: &quot;windrichting&quot;. <span>$\\$</span><img src="../assets/fig_9_8.png" alt="windrichting"/></td></tr><tr><td style="text-align: left">16</td><td style="text-align: left">Kopieer de tekst uit <a href="#Javascript-code-windrichting">&quot;Javascript code windrichting&quot;</a> naar het code blok.</td></tr><tr><td style="text-align: left">17</td><td style="text-align: left">Druk op de toets &quot;Done&quot;.</td></tr><tr><td style="text-align: left">18</td><td style="text-align: left">Dubbelklik op de derde &quot;functie&quot; en geef het de naam: &quot;windsnelheid&quot;.  <span>$\\$</span><img src="../assets/fig_9_9.png" alt="fig_9_9"/></td></tr><tr><td style="text-align: left">19</td><td style="text-align: left">Kopieer de tekst uit <a href="#Javascript-code-windsnelheid-in-Beaufort">Javascript code windsnelheid in Beaufort</a>. Hiermee converteren we de windsnelheid (km/uur) naar Beaufort. De tabel vind je <a href="https://www.kuijntjes.nl/weer/windsnelheid.htm">hier</a>.</td></tr><tr><td style="text-align: left">20</td><td style="text-align: left">Druk op de toets &quot;Done&quot;.</td></tr><tr><td style="text-align: left">21</td><td style="text-align: left">Dubbelklik op &quot;chart&quot; en verander: <span>$\\$</span>- Group: [Buiten] Leusden <span>$\\$</span>- Label: Buitentemperatuur <span>$\\$</span><img src="../assets/fig_9_33.png" alt="fig_9_33"/></td></tr><tr><td style="text-align: left">22</td><td style="text-align: left">Druk op de toets &quot;Done&quot;.</td></tr><tr><td style="text-align: left">23</td><td style="text-align: left">Voor de &quot;text&quot; knooppunten, verander de &quot;Group&quot; in &quot;[Buiten] Leusden&quot; en het &quot;Label&quot; in wat het doet.</td></tr><tr><td style="text-align: left">24</td><td style="text-align: left">Als je klaar bent, druk dan op de knop &quot;Deploy&quot;en laat het resultaat in je browser zien. De drie horizontale streepjes is het menu-symbool. <span>$\\$</span><img src="../assets/fig_9_20.png" alt="fig_9_20"/></td></tr><tr><td style="text-align: left"></td><td style="text-align: left"></td></tr></table><h3 id="Javascript-code-windrichting"><a class="docs-heading-anchor" href="#Javascript-code-windrichting">Javascript code windrichting</a><a id="Javascript-code-windrichting-1"></a><a class="docs-heading-anchor-permalink" href="#Javascript-code-windrichting" title="Permalink"></a></h3><pre><code class="nohighlight hljs">let test = msg.payload.currentConditions.winddir;
let windrichting = &#39;&#39;;

if (test &gt;= 360 - 22.5) {
    windrichting = &#39;N&#39;;
} else if (test &lt; 22.5) {
    windrichting = &#39;N&#39;;
} else if (test &gt;= 325 - 22.5 &amp;&amp; test &lt;= 325 + 22.5) {
    windrichting = &#39;NW&#39;;
} else if (test &gt;= 270 - 22.5 &amp;&amp; test &lt;= 270 + 22.5) {
    windrichting = &#39;W&#39;
} else if (test &gt;= 225 - 22.5 &amp;&amp; test &lt;= 225 + 22.5) {
    windrichting = &#39;ZW&#39;;
} else if (test &gt;= 180 - 22.5 &amp;&amp; test &lt;= 180 + 22.5) {
    windrichting = &#39;Z&#39;;
} else if (test &gt;= 135 - 22.5 &amp;&amp; test &lt;= 135 + 22.5) {
    windrichting = &#39;ZO&#39;;
} else if (test &gt;= 90 - 22.5 &amp;&amp; test &lt;= 90 + 22.5) {
    windrichting = &#39;O&#39;;
} else if (test &gt;= 45 - 22.5 &amp;&amp; test &lt;= 45 + 22.5) {
    windrichting = &#39;NO&#39;;
}

return { payload: windrichting };</code></pre><p>Deze code doet net alsof het een windwijzer is. Het krijgt een nummer dat vertelt waar de wind vandaan komt en geeft dan een letter die past bij die richting.</p><p>Bijvoorbeeld, als de wind uit het noorden komt, zal de code de letter &quot;N&quot; teruggeven.</p><p>De code bekijkt het nummer om te zien welke richting het dichtstbij ligt en kiest dan de letter voor die richting. Tot slot geeft het de letter terug, zodat we die ergens anders kunnen gebruiken.</p><h3 id="Javascript-code-windsnelheid-in-Beaufort"><a class="docs-heading-anchor" href="#Javascript-code-windsnelheid-in-Beaufort">Javascript code windsnelheid in Beaufort</a><a id="Javascript-code-windsnelheid-in-Beaufort-1"></a><a class="docs-heading-anchor-permalink" href="#Javascript-code-windsnelheid-in-Beaufort" title="Permalink"></a></h3><pre><code class="nohighlight hljs">let test = msg.payload.currentConditions.windspeed;
let windsnelheid = &#39;&#39;;

if (test &lt;= 1) {
    windsnelheid = &#39;0&#39;;
} else if (test &gt; 1 &amp;&amp; test &lt;= 5) {
    windsnelheid = &#39;1&#39;;
} else if (test &gt; 5 &amp;&amp; test &lt;= 11) {
    windsnelheid = &#39;2&#39;
} else if (test &gt; 11 &amp;&amp; test &lt;= 19) {
    windsnelheid = &#39;3&#39;;
} else if (test &gt; 19 &amp;&amp; test &lt;= 28) {
    windsnelheid = &#39;4&#39;;
} else if (test &gt; 28 &amp;&amp; test &lt;= 38) {
    windsnelheid = &#39;5&#39;;
} else if (test &gt; 38  &amp;&amp; test &lt;= 49) {
    windsnelheid = &#39;6&#39;;
} else if (test &gt; 49  &amp;&amp; test &lt;= 61) {
    windsnelheid = &#39;7&#39;;
} else if (test &gt; 61  &amp;&amp; test &lt;= 74) {
    windsnelheid = &#39;8&#39;;
} else if (test &gt; 74  &amp;&amp; test &lt;= 88) {
    windsnelheid = &#39;9&#39;;
} else if (test &gt; 88  &amp;&amp; test &lt;= 102) {
    windsnelheid = &#39;10&#39;;
} else if (test &gt; 102  &amp;&amp; test &lt;= 117) {
    windsnelheid = &#39;11&#39;;
} else if (test &gt; 117 ) {
    windsnelheid = &#39;12&#39;;
}

return { payload : windsnelheid };</code></pre><p>Deze code laat zien hoe hard de wind waait. Het krijgt een nummer dat vertelt hoe de wind waait in km/uur en geeft dan een cijfer dat past bij de kracht van de wind uitgedrukt in Beaufort.</p><p>Bijvoorbeeld, als de wind heel zachtjes waait, zal de code het cijfer &quot;0&quot; teruggeven. &quot;0&quot; beteket windstil. Als de wind heel hard waait, kan het het cijfer &quot;12&quot; teruggeven. &quot;12&quot; betekent orkaankracht. </p><p>Tot slot geeft het dat cijfer terug, zodat we dat ergens anders kunnen gebruiken.</p><p>Hoe hard de wind waait heb ik bepaald met de gegevens uit deze <a href="https://www.kuijntjes.nl/weer/windsnelheid.htm">tabel</a>. </p><h2 id="Samenvatting"><a class="docs-heading-anchor" href="#Samenvatting">Samenvatting</a><a id="Samenvatting-1"></a><a class="docs-heading-anchor-permalink" href="#Samenvatting" title="Permalink"></a></h2><p>Met Node-RED Dashboard module kun je een dashboard maken om live data te visualiseren. Het dashboard kan informatie over de temperatuur, vochtigheid en windrichting binnen en buiten tonen. Om dit te doen, heb je een Raspberry Pi 3B+ met Ubuntu Server 22.04 nodig, evenals geïnstalleerde Docker, Portainer, Node-RED en MQTT broker. Je hebt ook een ESP8266 met een DHT22-sensor nodig die gegevens naar de MQTT broker stuurt. Om het dashboard te maken, download je de Node-RED Dashboard module en stel je vervolgens het dashboard samen door de mqtt in- en gauge-knooppunten te slepen, de IP-adressen van de Raspberry Pi in te voeren en de juiste gegevens en namen in te voeren. Je kunt ook weergegevens van Visual Crossing ophalen met een API-sleutel en de informatie visualiseren.In dit hoofdstuk leer je hoe je met Node-RED snel een live data dashboard kunt maken. Dit dashboard kan informatie laten zien zoals de temperatuur, luchtvochtigheid, windrichting en -snelheid. Om dit te doen, heb je een Raspberry Pi 3B+ nodig met Ubuntu Server 22.04, geïnstalleerde Docker, Portainer, Node-RED en MQTT broker, een ESP8266 met een DHT22 die gegevens stuurt naar de MQTT broker en een wifi-netwerk waar alle onderdelen op aangesloten zijn.</p><p>Stap 1: De Node-RED Dashboard module downloaden. Deze module biedt verschillende onderdelen, zoals een metertje, een grafiek en tekstweergave, die speciaal zijn ontworpen om een dashboard te maken. Je moet deze module zelf toevoegen aan Node-RED.</p><p>Stap 2: Het dashboard samenstellen. Hier leer je hoe je verschillende onderdelen kunt toevoegen aan je dashboard en hoe je deze kunt verbinden met de MQTT broker. Je voegt bijvoorbeeld een &quot;mqtt in&quot;, &quot;gauge&quot; en &quot;text&quot; knooppunt toe om de temperatuur en luchtvochtigheid weer te geven.</p><p>Stap 3: Weergegevens ophalen en op dashboard weergeven. Je leert hoe je gegevens over het weer in Leusden kunt ophalen van een website en deze kunt integreren in je dashboard. Om je dashboard te bekijken, typ je het IP-adres van je Raspberry Pi in je webbrowser, gevolgd door /ui.</p><p>Met deze stappen kun je snel en gemakkelijk een dashboard maken om live data te visualiseren en te monitoren.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../chapter8/">« 8 Temperatuur meten</a><a class="docs-footer-nextpage" href="../chapter10/">10 Domoticz installeren »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 6 July 2023 16:09">Thursday 6 July 2023</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
